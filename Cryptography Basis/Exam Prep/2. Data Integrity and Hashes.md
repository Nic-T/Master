# Data Integrity and Hashes

## Definition

Mathematical functions that map input data of any size to a fixed-size string

## Core Concepts

### 1. Integrity vs. Condifentiality

- Hashes provide integrity(proof the data is unchanged), not confidentiality.
- They are **one-way** functions and cannot be reversed to find the original messag

### 2. The Avalanche Effect

- A tiny change in the input (e.g., changing "A" to "a") results in a completely different hash output

### 3. Collisions

- A collision occurs when two different inputs produce the exact same hash
- A secure hash function must make finding collisions computationally infeasible

### The Algorithms

1. **MD5**

- Produces a 128-bit hash.
- It is deprecated and considered insecure agains well-funded attackers

2. **SHA-1**

- Produces a 160-bit hash
- It is deprecated and considered insecure against well-funded attackers

3. **SHA-2**

- The current industry standard (e.g., SHA-256)
- Considered secure for modern applications

4. **SHA-3 (Keccak)**

- The newest standard
- Selected by NIST to eventually replace SHA-2

## Advanced Structures

### 1. HMAC (Hash-Based MAC)

- Used to prevent an attacker from modifying a message and recalculating the hash
- Combines the hash with a secret key
- Provides both integrity and authentication

### 2. Merkle Trees

- Binary trees of hashes used in blockchains to efficiently verify the integrity of large datasets without downloading the whole history

## Attacks on Hash Functions

1. ### The Birthday Paradox

- For N different possibilities of an event to happen, then you need square root of N random items for them to have a 50% chance of a collision (e.g., To find a collision with only a 50% probability, you only need to generate 2^(n/2) hashes not 2^n)
- For 365 different possibilities of birthdays, you need Sqrt(365) = ~23, randomly chosen people, for 50% chance of two people sharing same birthday (same day, not day and year)

2. ### Rainbow Tables

- Pre-computed tables of common passwords and their hash values used to reverse hashes quickly
- **Defense**: Use Salting

3. ### Length-Extension Attack

- An attacker can append data to a message and calculate a valid new hash without knowing the original secret
- Affects MD5, SHA-1, SHA-2
- **Defense**: USE HMAC or SHA-3

4. ### Password Security (Salting)

- A random, non-secret value generated per user and concatenated with the password before hashing.
- It forces an attacker to re-compute Rainbow Tables for every single user, cancelling their advantage.
- Never use a global salt for all users; use a random salt for each user

5. ### HMAC (Hash-based Message Authentication Code)

- Combines a hash function with a Secret Key
- Provides Data Integrity AND Authentication (proof of origin)
- Formula: HMAC(K, m) = H((K' ⊕ opad) || H((K' ⊕ ipad) || m))
